{
    "version": "17.8.7",
    "description": "Visual Studio Enterprise is a powerful, comprehensive IDE for developers designing, building, testing, and deploying complex applications for any platformâ€”including the Microsoft stack. Preview Channel is meant for those who are eager to try out the very latest Visual Studio features and fixes. Workload Formal Name : visual studio core editor (included with visual studio enterprise 2022), Workload Description : the visual studio core shell experience, including syntax-aware code editing, source code control and work item management.",
    "homepage": "https://visualstudio.microsoft.com/vs/preview/",
    "license": "Freemium",
    "url": "https://aka.ms/vs/17/pre/vs_enterprise.exe",
    "hash": "95a203aba768dde3a5760695c5040906c19ebe68ea0f79112d84e952eeb70415",
    "installer": {
        "args": [
            "--add=Microsoft.VisualStudio.Workload.coreeditor",
            "--removeOos=true",
            "--passive",
            "--norestart",
            "--wait"
        ],
        "keep": true
    },
    "uninstaller": {
        "script": [
            "Start-Process -FilePath \"$dir\\vs_enterprise.exe\" -ArgumentList \"--remove=Microsoft.VisualStudio.Workload.coreeditor\", \"--channelId=VisualStudio.17.Preview\", \"--productId=Microsoft.VisualStudio.Product.Enterprise\", \"--passive\", \"--norestart\", \"--wait\" -Wait",
            "if ($cmd -ceq 'uninstall') {",
            "if ((scoop list | Select-String -Pattern '(?<visualStudioWorkloadApp>visual-studio-2022-preview-enterprise-(?<visualStudioWorkloadInternalName>[a-z]+)(?<vSWorkloadAppFullVariant>-full)?(?<vSWorkloadAppRecommendedVariant>-recommended)?-installer)' | ForEach-Object -Process { $_.Matches}) -is [System.Text.RegularExpressions.Group]) {",
            "Start-Process -FilePath \"$dir\\vs_enterprise.exe\" -ArgumentList \"uninstall\", \"--channelId=VisualStudio.17.Preview\", \"--productId=Microsoft.VisualStudio.Product.Enterprise\", \"--passive\", \"--norestart\", \"--wait\" -Wait",
            "Start-Process -FilePath \"${Env:ProgramFiles(x86)}\\Microsoft Visual Studio\\Installer\\vs_installer.exe\" -ArgumentList \"/uninstall\" -Wait",
            "Remove-Item \"$([System.Environment]::GetFolderPath('commonstartmenu'))\\Programs\\Visual Studio Installer.lnk\"",
            "}",
            "}"
        ]
    },
    "checkver": {
        "url": "https://learn.microsoft.com/en-us/visualstudio/releases/2022/release-notes-preview",
        "regex": "Visual Studio 2022 version ((?<major>[\\d.]+) Preview (?<minor>\\d\\d?))",
        "replace": "${major}.${minor}"
    },
    "autoupdate": {
        "url": "https://aka.ms/vs/17/pre/vs_enterprise.exe"
    }
}
